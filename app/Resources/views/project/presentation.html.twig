
{% extends 'base.html.twig' %}

{% block title %}
    {{ project.projectName }}
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('assets/js/editProject.js') }}"></script>
{% endblock %}

{% block stylesheets %}
    <link href="{{ asset('assets/css/project-style.css') }}" rel="stylesheet" />
{% endblock %}

{% set formClass = {'attr': {'class':'form-control','disabled':'' } } %}

{% block body %}
    {% if is_granted('ROLE_USER') %}
        {% include 'toolbar.html.twig' %}
    {% endif %}
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-2 text-center">
                <h2>Project "{{ project.projectName }}" </h2>
            </div>
            <div class="col-xs-2 text-center" >
                <h4>
                    Leader : {{ project.leader.username }} 
                </h4>
                <h4>
                    Secretary : {{ project.secretary.username }}
                </h4>
            </div>
            <div class="col-xs-8">
                <h3>Participants :</h3>
                <ul class="list-group list-inline" >
                    {% for part in project.participants %}
                        <li class="list-group-item" >
                            {{ part.username }}
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-6">
                {% if project.roles|length %}
                    <h3>Other roles :</h3>
                    <ul class="list-group" id='list-roles' >
                        {% for ro in project.roles %}
                            <li class="list-group-item" data-id="{{ ro.id }}" >
                                <strong>{{ ro.student.username }}</strong> :
                                {{ ro.roleName }}
                                {% if canEdit %}
                                    <span class="pull-right">
                                        <a href="#"
                                           class="btn btn-primary btn-xs">
                                            <i class="glyphicon glyphicon-pencil"></i>
                                            Edit
                                        </a>
                                        <a href="{{ path('remove-role',{ 'roleId' : ro.id }) }}"
                                           class="btn btn-warning btn-xs btn-remove">
                                            <i class="glyphicon glyphicon-remove"></i>
                                            Delete
                                        </a>
                                    </span>
                                {% endif %}
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <h3>No roles</h3>
                {% endif %}
                {% if canEdit %}
                    <a href="{{ path('add-role') }}"
                       data-project="{{ project.id }}"
                       id="button-add-role"
                       class="btn btn-default" >
                        <i class="glyphicon glyphicon-plus"></i>
                        Add role
                    </a>
                {% endif %}
            </div>
            <div class="col-xs-12 col-sm-6">
                {% if project.meetings|length %}
                    <h3>Meetings : </h3>
                    <ul class="list-group" id="list-meetings" >
                        {% for meet in project.meetings %} 
                            <li class="list-group-item" data-id="{{ meet.id }}" >
                                Meeting at  {{ meet.date|date('d/m/Y H:i') }} in room {{ meet.room }}
                                {% if canEdit %}
                                    <span class="pull-right">
                                        <a href="#"
                                           class="btn btn-primary btn-xs">
                                            <i class="glyphicon glyphicon-pencil"></i>
                                            Edit
                                        </a>
                                        <a href="{{  path('remove-meeting',{ 'meetingId' : meet.id }) }}"
                                           class="btn btn-warning btn-xs btn-remove">
                                            <i class="glyphicon glyphicon-remove"></i>
                                            Delete
                                        </a>
                                    </span>
                                {% endif %}
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <h3>No meetings for this project</h3>
                {% endif %}
                {% if canEdit %}
                    <a href="{{ path('add-meeting') }}"
                       data-project="{{ project.id }}"
                       id="button-add-meeting"
                       class="btn btn-default">
                        <i class="glyphicon glyphicon-plus"></i>
                        Add meeting
                    </a>
                {% endif %}
            </div>
        </div>
        {% if is_granted('ROLE_ADMIN') %}
            <div class="row">
                <div class="col-xs-12">
                    {% if project.locked %}
                        <a class="btn btn-success" 
                           href="{{ path('unlockproject',{'proj' : project.id}) }}">
                            <i class="fa fa-unlock" ></i>
                            Unlock
                        </a>
                    {% else %}
                        <a class="btn btn-warning"
                           href="{{ path('lockproject',{'proj' : project.id}) }}">
                            <i class="fa fa-lock" ></i>
                            Lock
                        </a>
                    {% endif %}
                    <a class="btn btn-danger"
                       href="{{ path('deleteproject',{'projId': project.id}) }}">
                        <i class="glyphicon glyphicon-trash" ></i>
                        Delete
                    </a>
                </div>
            </div>
        {% endif %}

        {% if canEdit %}
            <div class="modal fade" id="modal-main" tabindex="-1" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content" id="modal-main-content" >
                    </div><!-- /.modal-content -->
                </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
            <div class="alert alert-success alert-dismissible" role="alert" id='message-alert'>
                <button type="button" class="close" id="close-alert"  aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                The <span id="removed-object" > </span> was removed.
                <a href="#" class="alert-link" id="cancel-action" > Cancel</a>
            </div>
            <span id="path-remove-role" 
                  data-href="{{ path('remove-role',{ 'roleId' : '__name__' }) }}" >
            </span>
            <span id="path-remove-meeting"
                  data-href="{{ path('remove-meeting',{ 'meetingId' : '__name__' }) }}" >
            </span>
        {% endif %}
    </div>
{% endblock %}

